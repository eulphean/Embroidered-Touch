(this.webpackJsonpFabricInstrument=this.webpackJsonpFabricInstrument||[]).push([[0],{106:function(e,t,n){e.exports=n(153)},111:function(e,t,n){},112:function(e,t,n){},153:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(76),s=n.n(o),r=(n(111),n(112),n(2)),l=n(3),c=n(7),u=n(6),h=n(1),f=n(4),d=n(8),g="#849099",m="#FFFFFF",p="#000000",v="4px",b="12px",E="20px",y={container:{position:"relative"},button:{width:"125px",height:"35px"}},k=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{style:y.container},i.a.createElement("button",{onClick:this.props.onClick?this.onClick.bind(this):function(){},style:y.button},this.props.children))}},{key:"onClick",value:function(){this.props.onClick()}}]),n}(i.a.Component),C=Object(h.a)(k),O={container:{position:"relative"},titleContainer:{display:"flex",backgroundColor:g,color:p,padding:v}},j=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{style:O.container},i.a.createElement("div",{style:O.titleContainer},"EMBROIDERED TOUCH"),i.a.createElement("button",{onClick:this.props.logout},"Logout"))}}]),n}(i.a.Component),x=Object(h.a)(j),L=Object(h.a)(d.b),I={container:{position:"relative",color:m,padding:E}},S=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{style:I.container},i.a.createElement("div",null,"Initial Set-Up"),i.a.createElement(C,null,i.a.createElement(L,{to:"/calibration"},"PAIR")))}}]),n}(i.a.Component),w=Object(h.a)(S),U=n(105),R=n.n(U),D="https://fabric-backend.herokuapp.com",A=new(function(){function e(){Object(r.a)(this,e),this.siteURL=D+"/app",this.loginURL=D+"/login",this.signupURL=D+"/signup",this.socket=R()(this.siteURL,{reconnection:!0,reconnectionDelay:500,reconnectionAttempts:1/0}),this.socket.once("connect",this.subscribe.bind(this)),this.canBroadcast=!1,this.sensorDataCallback="",this.readAllConfigCallback=""}return Object(l.a)(e,[{key:"subscribe",value:function(){console.log("Connected"),this.socket.on("time",this.logTime.bind(this)),this.socket.on("receiveSensorData",this.handleSensorData.bind(this)),this.socket.on("receiveAllConfigs",this.handleAllConfigs.bind(this))}},{key:"updateRoom",value:function(e){this.socket.emit("room"),this.canBroadcast=!this.canBroadcast,this.sensorDataCallback=e}},{key:"broadcastText",value:function(e){this.canBroadcast&&this.socket.emit("sensorData",e)}},{key:"handleSensorData",value:function(e){this.sensorDataCallback(e)}},{key:"saveUserConfig",value:function(e){this.socket.emit("saveUserConfig",e)}},{key:"updateUserConfig",value:function(e){this.socket.emit("updateUserConfig",e)}},{key:"deleteUserConfig",value:function(e){this.socket.emit("deleteUserConfig",e)}},{key:"requestForConfigs",value:function(e){this.readAllConfigCallback=e,this.socket.emit("requestForConfigs")}},{key:"handleAllConfigs",value:function(e){this.readAllConfigCallback(e)}},{key:"disconnect",value:function(){console.log("Socket Server Disconnected.")}},{key:"logTime",value:function(e){}}]),e}()),T=new(function(){function e(){Object(r.a)(this,e),this.cutoffVals=[{co:new Array(12).fill(150)},{co:new Array(12).fill(150)}],this.configs={},this.listeners=[],A.requestForConfigs(this.onAllConfigsLoaded.bind(this))}return Object(l.a)(e,[{key:"subscribe",value:function(e){var t=this;this.listeners.push(e);return function(){t.listeners=t.listeners.filter((function(t){return e!==t}))}}},{key:"setState",value:function(e,t,n){this.cutoffVals[e].co[t]=n}},{key:"onAllConfigsLoaded",value:function(e){for(var t=e,n=0;n<t.length;n++){var a=t[n].name,i=t[n].config;this.configs[a]=i}console.log(this.configs);for(var o=0;o<this.listeners.length;o++)this.listeners[o](this.configs)}},{key:"saveParams",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={},a=0;a<2;a++){for(var i={cutoff:{}},o=0;o<12;o++){var s=this.cutoffVals[a].co;i.cutoff[o]=s[o]}n[a.toString()]=i}var r={name:e,config:JSON.stringify(n)};t?(A.saveUserConfig(r),this.configs[e]=n):(A.updateUserConfig(r),this.configs[e]=n)}},{key:"updateParams",value:function(e){this.saveParams(e,!1)}},{key:"getCutoffValue",value:function(e,t,n){return this.configs[e]?this.configs[e][t].cutoff[n]:this.cutoffVals[t].co[n]}},{key:"getDefaultConfig",value:function(){for(var e={},t=0;t<2;t++){for(var n={cutoff:{}},a=0;a<12;a++){var i=this.cutoffVals[t].co;n.cutoff[a]=i[a]}e[t.toString()]=n}return e}}]),e}()),F=(Object(h.a)(d.b),{container:{display:"flex",flexDirection:"column",position:"relative",color:m,padding:E},buttons:{display:"flex",flexDirection:"row",marginTop:b},inputContainer:{display:"flex",flexDirection:"column",marginTop:b},input:{width:"100px",marginTop:v},resultLabel:{marginTop:v}}),N=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={username:"",password:"",message:"Message"},a.loginUrl=A.loginURL,a.signupURL=A.signupURL,console.log(a.context),a}return Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{style:F.container},i.a.createElement("div",null,"LOGIN"),i.a.createElement("div",{style:F.input},i.a.createElement("input",{style:F.input,onChange:this.usernameChanged.bind(this),type:"text",placeholder:"username..",value:this.state.username}),i.a.createElement("input",{style:F.input,onChange:this.passwordChanged.bind(this),type:"password",placeholder:"password..",value:this.state.password})),i.a.createElement("div",{style:F.buttons},i.a.createElement(C,{onClick:this.onClickLogin.bind(this)},"Sign In"),i.a.createElement(C,{onClick:this.onClickSignUp.bind(this)},"Create Account")),i.a.createElement("div",{style:F.resultLabel},this.state.message))}},{key:"onClickLogin",value:function(e){var t=this,n=new Request(this.loginUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.state.username,password:this.state.password})});fetch(n).then((function(e){200===e.status?e.json().then((function(e){var n=e.result;if("user_not_found"===n)t.props.onLogin(!1),t.setState({message:"Account not found"});else if("user_found"===n){var a=e.config;console.log("Read config: "+Object.keys(a)),t.props.onLogin(!0),t.setState({message:"Account found"})}})):console.error("Something wrong")})).then((function(e){console.debug(e)})).catch((function(e){console.error(e)}))}},{key:"onClickSignUp",value:function(e){var t=this,n=this.state.username,a=this.state.password,i=T.getDefaultConfig();console.log(i);var o=new Request(this.signupURL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:a,config:i})});fetch(o).then((function(e){200===e.status?e.json().then((function(e){var n=e.result;"user_exists"===n?t.setState({message:"User Exists"}):"new_user"===n&&t.setState({message:"New User Created"})})):console.error("Something wrong")})).then((function(e){console.debug(e)})).catch((function(e){console.error(e)}))}},{key:"usernameChanged",value:function(e){var t=e.target.value;this.setState({username:t})}},{key:"passwordChanged",value:function(e){var t=e.target.value;this.setState({password:t})}}]),n}(i.a.Component),P=Object(h.a)(N),B=Object(h.a)(d.b),V={container:{display:"flex",flexDirection:"column",position:"relative",color:m,padding:E}},q=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{style:V.container},"CALIBRATION",i.a.createElement(C,null,i.a.createElement(B,{to:"/l-0"},"CALIBRATE")))}}]),n}(i.a.Component),J=Object(h.a)(q),_=Object(h.a)(d.b),M={container:{position:"relative",color:m},modeContainer:{display:"flex",flexDirection:"column"}},G=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{style:M.container},i.a.createElement("div",null,"MODE"),i.a.createElement("div",{style:M.modeContainer},i.a.createElement(C,null,i.a.createElement(_,null,"CONNECTION")),i.a.createElement(C,null,i.a.createElement(_,null,"SOLO")),i.a.createElement(C,null,i.a.createElement(_,{to:"/testcal"},"SETUP"))))}}]),n}(i.a.Component),H=Object(h.a)(G),X=Object(h.a)(d.b),z={container:{display:"flex",flexDirection:"column",position:"relative",color:m}},K=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{style:z.container},i.a.createElement("div",null,"Testing Calibration"),i.a.createElement(C,null,i.a.createElement(X,{to:"/selectmode"},"SAVE")))}}]),n}(i.a.Component),Q=Object(h.a)(K),W=Object(h.a)(d.b),Y={container:{display:"flex",flexDirection:"column",position:"relative",color:m},input:{width:"40px",height:"20px",marginBottom:"10px",marginTop:"5px"}},Z=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.getNextPath();return i.a.createElement("div",{style:Y.container},"Chipset ",this.props.chipsetId,i.a.createElement("br",null),"Sensor ",this.props.sensorIdx,i.a.createElement(C,null,i.a.createElement(W,{to:e},"NEXT")))}},{key:"getNextPath",value:function(){var e="",t=this.props.sensorIdx<11?this.props.sensorIdx:0;return 0===this.props.chipsetId&&this.props.sensorIdx<11?(e="/l-"+(t+=1),console.log(e)):(e="/r-"+(t+=1),console.log(e)),1===this.props.chipsetId&&11===this.props.sensorIdx&&(e="/testcal"),e}}]),n}(i.a.Component),$=Object(h.a)(Z),ee={container:{position:"relative",backgroundColor:p,padding:b}},te=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={isConnected:!1,receiveVal:"Receive Text",isLoggedIn:!1},a.chipsetCollectionRef=i.a.createRef(),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.getSensorCalibrationPages(),t=this.state.isLoggedIn?i.a.createElement(f.a,{to:"/setup"}):i.a.createElement(i.a.Fragment,null,i.a.createElement(x,null),i.a.createElement(P,{onLogin:this.hasLoggedIn.bind(this)})),n=this.state.isLoggedIn?i.a.createElement(i.a.Fragment,null,i.a.createElement(x,null),i.a.createElement(w,null)):i.a.createElement(f.a,{to:"/"}),a=this.state.isLoggedIn?i.a.createElement(i.a.Fragment,null,i.a.createElement(x,null),i.a.createElement(J,null)):i.a.createElement(f.a,{to:"/"}),o=this.state.isLoggedIn?i.a.createElement(i.a.Fragment,null,i.a.createElement(x,null),i.a.createElement(Q,null)):i.a.createElement(f.a,{to:"/"}),s=this.state.isLoggedIn?i.a.createElement(i.a.Fragment,null,i.a.createElement(x,null),i.a.createElement(H,null)):i.a.createElement(f.a,{to:"/"});return i.a.createElement("div",{style:ee.container},i.a.createElement(d.a,null,i.a.createElement(f.d,null,e,i.a.createElement(f.b,{path:"/selectmode"},s),i.a.createElement(f.b,{path:"/testcal"},o," "),i.a.createElement(f.b,{path:"/calibration"},a),i.a.createElement(f.b,{path:"/setup"},n),i.a.createElement(f.b,{path:"/"},t))))}},{key:"getSensorCalibrationPages",value:function(){for(var e="/l-",t=[],n=0;n<12;n++){var a=e+n,o=i.a.createElement(f.b,{key:"keyL:"+n,path:a},i.a.createElement(x,null),i.a.createElement($,{chipsetId:0,sensorIdx:n,key:"keyL:"+n}));t.push(o)}e="/r-";for(var s=0;s<12;s++){var r=e+s,l=i.a.createElement(f.b,{key:"keyR:"+s,path:r},i.a.createElement(x,null),i.a.createElement($,{chipsetId:1,sensorIdx:s,key:"keyR:"+s}));t.push(l)}return t}},{key:"hasLoggedIn",value:function(e){console.log("Login State: "+e),this.setState({isLoggedIn:e})}},{key:"logOut",value:function(){this.setState({isLoggedIn:!1})}}]),n}(i.a.Component),ne=Object(h.a)(te),ae=n(52);s.a.render(i.a.createElement(ae.a,null,i.a.createElement(ne,null)),document.getElementById("root"))}},[[106,1,2]]]);
//# sourceMappingURL=main.13f888e3.chunk.js.map