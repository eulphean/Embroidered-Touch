(this.webpackJsonpFabricInstrument=this.webpackJsonpFabricInstrument||[]).push([[0],{100:function(e,t,n){e.exports=n(151)},105:function(e,t,n){},106:function(e,t,n){},151:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),s=n(67),o=n.n(s),c=(n(105),n(106),n(8)),l=n(9),r=n(37),h=n(36),u=n(20),f=n(26),d=n(68),g=n.n(d),v=n(69),m=n.n(v),p=new(function(){function e(){Object(c.a)(this,e),this.socket=m()("https://fabric-backend.herokuapp.com/app",{reconnection:!0,reconnectionDelay:500,reconnectionAttempts:1/0}),this.socket.once("connect",this.subscribe.bind(this)),this.canBroadcast=!1,this.sensorDataCallback="",this.readAllConfigCallback=""}return Object(l.a)(e,[{key:"subscribe",value:function(){console.log("Connected"),this.socket.on("time",this.logTime.bind(this)),this.socket.on("receiveSensorData",this.handleSensorData.bind(this)),this.socket.on("receiveAllConfigs",this.handleAllConfigs.bind(this))}},{key:"updateRoom",value:function(e){this.socket.emit("room"),this.canBroadcast=!this.canBroadcast,this.sensorDataCallback=e}},{key:"broadcastText",value:function(e){this.canBroadcast&&this.socket.emit("sensorData",e)}},{key:"handleSensorData",value:function(e){this.sensorDataCallback(e)}},{key:"saveUserConfig",value:function(e){this.socket.emit("saveUserConfig",e)}},{key:"updateUserConfig",value:function(e){this.socket.emit("updateUserConfig",e)}},{key:"deleteUserConfig",value:function(e){this.socket.emit("deleteUserConfig",e)}},{key:"requestForConfigs",value:function(e){this.readAllConfigCallback=e,this.socket.emit("requestForConfigs")}},{key:"handleAllConfigs",value:function(e){console.log("Handle all config: "+e),this.readAllConfigCallback(e)}},{key:"disconnect",value:function(){console.log("Socket Server Disconnected.")}},{key:"logTime",value:function(e){console.log("Socket Connection Alive: "+e)}}]),e}()),y={container:{position:"relative",marginLeft:"10px",marginTop:"20px"},configs:{display:"flex",flexDirection:"row",alignItems:"center"},textArea:{marginLeft:"10px",height:"15px"},sensor:{width:"30px",height:"20px",marginRight:"10px",marginTop:"10px"},button:{marginTop:"10px",marginRight:"10px"}},C=function(e){Object(r.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={configName:"",configs:[],selectVal:"newconfig",s1:"",s2:"",s3:""},p.requestForConfigs(a.onAllConfigsLoaded.bind(Object(f.a)(a))),a.selectRef=i.a.createRef(),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.getOptions();return i.a.createElement("div",{style:y.container},i.a.createElement("div",{style:y.configs},i.a.createElement("select",{value:this.state.selectVal,ref:this.selectRef,onChange:this.onSelectChange.bind(this)},e),i.a.createElement("textarea",{style:y.textArea,value:this.state.configName,onChange:this.onTextAdded.bind(this),placeholder:"Type config name"})),i.a.createElement("div",{style:y.buttons},i.a.createElement("button",{style:y.button,onClick:this.onSave.bind(this)},"Save"),i.a.createElement("button",{style:y.button,onClick:this.onDelete.bind(this)},"Delete")),i.a.createElement("div",{style:y.sensorData},i.a.createElement("input",{onChange:this.s1Change.bind(this),type:"text",style:y.sensor,value:this.state.s1}),i.a.createElement("input",{onChange:this.s2Change.bind(this),type:"text",style:y.sensor,value:this.state.s2}),i.a.createElement("input",{onChange:this.s3Change.bind(this),type:"text",style:y.sensor,value:this.state.s3})))}},{key:"onSave",value:function(){var e=this.selectRef.current.value,t={};if(t.s1=this.state.s1,t.s2=this.state.s2,t.s3=this.state.s3,"newconfig"===e)if(this.state.configName.length>0){t.name=this.state.configName,p.saveUserConfig(t);var n=this.state.configs;n.push(t),this.setState({configs:n,selectVal:t.name,configName:""})}else console.warn("Empty config name.");else t.name=e,p.updateUserConfig(t)}},{key:"onDelete",value:function(){var e=this.selectRef.current.value;p.deleteUserConfig(e);var t=this.state.configs;g.a.remove(t,(function(t){return e===t.name})),this.setState({selectVal:"newconfig",s1:"",s2:"",s3:"",configs:t})}},{key:"s1Change",value:function(e){this.setState({s1:e.target.value})}},{key:"s2Change",value:function(e){this.setState({s2:e.target.value})}},{key:"s3Change",value:function(e){this.setState({s3:e.target.value})}},{key:"onSelectChange",value:function(e){var t=e.target.value;if("newconfig"!==t)for(var n=this.state.configs,a=0;a<n.length;a++){if(n[a].name===t){var i=n[a].s1,s=n[a].s2,o=n[a].s3;this.setState({selectVal:t,s1:i,s2:s,s3:o});break}}else this.setState({selectVal:t})}},{key:"getOptions",value:function(){var e=[];e.push(i.a.createElement("option",{key:"new",value:"newconfig"},"newconfig"));for(var t=0;t<this.state.configs.length;t++){var n=this.state.configs[t].name;e.push(i.a.createElement("option",{key:n,value:n},n))}return e}},{key:"onTextAdded",value:function(e){this.setState({configName:e.target.value})}},{key:"onAllConfigsLoaded",value:function(e){console.log("All configs loaded: "),this.setState({configs:e})}}]),n}(i.a.Component),b=Object(u.a)(C),k=n(98),x=n.n(k),E=new(function(){function e(t){Object(c.a)(this,e),this.myBLE=new x.a,this.myRxCharacteristic="",this.myTxCharacteristic="",this.callbackData=t,this.isReceivingData=!1}return Object(l.a)(e,[{key:"connect",value:function(){this.myBLE.connect("6e400001-b5a3-f393-e0a9-e50e24dcca9e",this.handleCharacteristics.bind(this))}},{key:"stop",value:function(){""!==this.myRxCharacteristic?(this.myBLE.stopNotifications(this.myRxCharacteristic),this.isReceivingData=!1):console.warn("BLE: Not initialized.")}},{key:"handleCharacteristics",value:function(e,t){e?console.log("error: ",e):(this.myTxCharacteristic=t[0],this.myRxCharacteristic=t[1],this.myBLE.startNotifications(this.myRxCharacteristic,this.handleIncomingData.bind(this),"string"),this.isReceivingData=!0,console.log("BLE: Successfully paired. Ready to communicate."))}},{key:"handleIncomingData",value:function(e){var t,n,a,i=e.split("-");t=i[0][0],n=i[0][1],a=i[1].split(","),this.callbackData(t,n,a)}},{key:"sendBuffer",value:function(e){""!==this.myTxCharacteristic?(this.myTxCharacteristic.writeValue(e),console.log("BLE: Buffer sent: "+e)):console.warn("BLE: Ensure Bluetooth is connected.")}}]),e}()),S=n(35),w=n.n(S),D=(n(150),n(99)),R=n.n(D),A=function(e){var t,n;e.preload=function(){t=e.loadSound(R.a)},e.setup=function(){e.noCanvas(),e.background(0),n=new w.a.Envelope(.1,.7,.3,.1)},e.draw=function(){e.noLoop()},e.play=function(){t.stop(),t.loop(),n.triggerAttack(t)}},O=new(function(){function e(){Object(c.a)(this,e),this.myP5=new w.a(A)}return Object(l.a)(e,[{key:"play",value:function(){this.myP5.play()}}]),e}()),T={container:{position:"relative"},content:{display:"flex",flexDirection:"column",width:"500px"},inputContainer:{display:"flex",flexDirection:"row"},input:{width:"200px",marginTop:"10px",marginLeft:"10px"},connected:{backgroundColor:"green"}},j=function(e){Object(r.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={isConnected:!1,receiveVal:"Receive Text"},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.state.isConnected?[T.input,T.connected]:T.input;return i.a.createElement("div",{style:T.content},i.a.createElement("button",{onClick:this.onClick.bind(this)},"BLE Connect"),i.a.createElement("button",{onClick:this.onPlay.bind(this)},"Play Some Audio"),i.a.createElement("div",{style:T.inputContainer},i.a.createElement("input",{onChange:this.onTextAdded.bind(this),style:T.input,type:"text",placeholder:"Transmit text."}),i.a.createElement("div",{style:T.input},this.state.receiveVal)),i.a.createElement("button",{style:e,onClick:this.enableConnect.bind(this)},"Enable Connect"),i.a.createElement(b,null))}},{key:"onClick",value:function(){E.connect()}},{key:"onPlay",value:function(){O.play()}},{key:"enableConnect",value:function(){this.setState({isConnected:!this.state.isConnected}),p.updateRoom(this.onSensorDataReceived.bind(this))}},{key:"onTextAdded",value:function(e){var t=e.target.value;p.broadcastText(t)}},{key:"onSensorDataReceived",value:function(e){console.log("Sensor Data received: "+e),this.setState({receiveVal:e})}}]),n}(i.a.Component),B=Object(u.a)(j),L=n(46);o.a.render(i.a.createElement(L.a,null,i.a.createElement(B,null)),document.getElementById("root"))},99:function(e,t,n){e.exports=n.p+"static/media/testsound.1f40cfce.wav"}},[[100,1,2]]]);
//# sourceMappingURL=main.133de463.chunk.js.map